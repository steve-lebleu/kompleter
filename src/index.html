<!DOCTYPE html>
<html>

<head lang="en">

    <title>jQuery auto-complete plugin - Kompleter.js</title>

    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!--[if IE]>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <![endif]-->

    <link href='https://fonts.googleapis.com/css?family=Lato|Open+Sans|Montserrat' rel='stylesheet' type='text/css' />
    <link href="css/kompleter.min.css" rel="stylesheet" type="text/css" media="screen" />

    <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js"></script>
    <![endif]-->
    <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>-->

    <script src="./js/kompleter.min.js"></script>

</head>

<body>

  <div id="wrapper">
    <input
      type="text"
      name="auto-complete"
      id="auto-complete"
      class="input--search"
      autocomplete="off"
      placeholder="Enter a city name ..."
      value=""
      data-url="files/kompleter.json"
      data-filter-on="Name"
      data-fields="Name,CountryCode,Population" />
  </div>

  <script type="text/javascript">
    function ready(fn) {
      if (document.readyState !== 'loading') {
        fn();
        return;
      }
      document.addEventListener('DOMContentLoaded', fn);
    };
    ready(() => {
      const input = document.getElementById('auto-complete');
      console.log(input);

      const dataSource = {
        url: 'http://localhost:3000/api',
        queryString: {  
          keys: {
            term: 'q',
            limit: 'limit',
            offset: 'offset',
            perPage: 'perPage',
          },
          values: {
            limit: 100,
            offset: 0,
            perPage: 10,
          }
        },
        fieldsToDisplay: [
          'Name',
          'CountryCode',
          'Population'
        ],
        propertyToValue: null,
      };

      const options = {
        animation: {
          type: 'fadeIn',
          duration: 500
        },
        cache: 5000
      };


      // Way 1
      input.kompleter(dataSource, options, { onKeyup: (value) => { console.log('cb.onKeyup ', value); }, onSelect: (value) => { console.log('cb.onSelect', value); }, onError: (value) => { console.log('cb.onError ', value); } })
      
      // Way 2
      // kompleter(input, options);

      // Way 3
      // kompleter('auto-complete', options);

    });
  </script>

</body>

</html>
